Description: |-
  An example stack that uses many of the syntax elements permitted in a
  CloudFormation template, but does not attempt to represent a realistic stack.

Mappings:
  Booleans:
    True: { true: true }
    False: { false: false }
  Lists:
    Candidates:
      Empty: []
      Singleton: [One]
      Pair:
        - One
        - Two
  Numbers:
    Prime:
      Eleven: 11
      Thirteen: 13
      Seventeen: 17
  Strings:
    Foos:
      Foo1: Foo1
      Foo2: Foo2
    Bars:
      Bar: Bar
  Table:
    Values:
      Boolean: true
      Float: 3.14
      List: ['1', '2', '3']
      Number: 42
      String: Baz

Conditions:
  IsUsEast1:
    Fn::Equals:
      - !Ref AWS::Region
      - us-east-1

Parameters:
  BucketNamePrefix:
    Type: String
    Default: bucket
    Description: "The prefix for the bucket name"

Resources:
  Bucket:
    Condition: IsUsEast1
    Type: AWS::S3::Bucket
    Properties:
      BucketName: !Sub ${BucketNamePrefix}-${AWS::StackName}-bucket
    DependsOn:
      - Queue
    DeletionPolicy: Retain
    Metadata:
      CostCenter: 1337

  Queue:
    Type: AWS::SQS::Queue
    Properties:
      QueueName:
        !Join
          - '-'
          - - { Ref: AWS::StackName }
            - !FindInMap [Strings, Bars, Bar]
            - !Select [1, Fn::GetAZs: { "!Ref": AWS::Region }]

Outputs:
  BucketArn:
    Condition: IsUsEast1
    Description: The ARN of the bucket in this template!
    Export: ExportName
    Value:
      !GetAtt Bucket.Arn
